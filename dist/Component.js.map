{"version":3,"file":"Component.js","names":["sap","ui","define","UIComponent","JSONModel","ResourceModel","DataPreprocessor","Store","Sorter","Filter","FilterOperator","FilterType","commonSelectors","commonActions","MessageToast","extend","metadata","interfaces","manifest","init","prototype","apply","this","arguments","oAthleteModel","setDefaultBindingMode","model","BindingMode","OneWay","setModel","oAthleteDetailsModel","oRouter","getRouter","aUrls","preprocessor","initState","entities","athletes","trainingSessions","games","app","filters","attribute","query","sorting","order","activeRoute","activeView","currentAthlete","routeParameters","appLoading","store","reduxStore","fetchData","then","result","oLoadDataAction","loadData","oData","processAthletes","sEntityName","dispatch","subscribe","console","log","getState","oState","navTo","selectActiveRoute","selectRouteParameters","setData","selectVisibleAthletes","selectActiveView","selectVisibleSessions","i18nModel","bundleName","initialize"],"sources":["Component.js"],"sourcesContent":["\r\nsap.ui.define([\r\n   \"sap/ui/core/UIComponent\",\r\n   \"sap/ui/model/json/JSONModel\",\r\n   \"sap/ui/model/resource/ResourceModel\",\r\n   \"ui5/fitnessApp/utils/DataPreprocessor\",\r\n   \"ui5/fitnessApp/store\",\r\n   \"sap/ui/model/Sorter\",\r\n   \"sap/ui/model/Filter\",\r\n\t\"sap/ui/model/FilterOperator\",\r\n\t\"sap/ui/model/FilterType\",\r\n    \"ui5/fitnessApp/selectors/commonSelectors\",\r\n    \"ui5/fitnessApp/actions/commonActions\",\r\n    \"sap/m/MessageToast\",\r\n], (UIComponent, JSONModel, ResourceModel, DataPreprocessor, Store, Sorter, Filter, FilterOperator, FilterType, commonSelectors, commonActions, MessageToast) => {\r\n    \"use strict\";\r\n \r\n    return UIComponent.extend(\"ui5.fitnessApp.Component\", {\r\n\r\n        metadata : {\r\n            \"interfaces\": [\"sap.ui.core.IAsyncContentCreation\"],\r\n            \"manifest\": \"json\",\r\n         },\r\n\r\n        init() {\r\n             // call the init function of the parent\r\n            UIComponent.prototype.init.apply(this, arguments);\r\n\r\n            // change default binding mode to oneway\r\n            var oAthleteModel = new JSONModel();\r\n            oAthleteModel.setDefaultBindingMode(sap.ui.model.BindingMode.OneWay);\r\n            this.setModel(oAthleteModel, \"athleteModel\");\r\n\r\n             var oAthleteDetailsModel = new JSONModel();\r\n            oAthleteDetailsModel.setDefaultBindingMode(sap.ui.model.BindingMode.OneWay);\r\n            this.setModel(oAthleteDetailsModel, \"athleteDetailsModel\");\r\n\r\n            // router reference\r\n            this.oRouter = this.getRouter();\r\n\r\n            // fetch data and preprocess\r\n            const aUrls = ['/client/model/data/athletes.json', '/client/model/data/training_sessions.json'];\r\n            const preprocessor = new DataPreprocessor();\r\n\r\n                // create initial state for store and instantiate store\r\n                const initState = {\r\n                    entities: {\r\n                        athletes: {},\r\n                        trainingSessions: {},\r\n                        games: {}\r\n                    },\r\n                    app: {\r\n                        filters:{\r\n                            athletes:{\r\n                                attribute: [\"surname\"],\r\n                                query: \"\"\r\n                            }\r\n                        },\r\n                        sorting: {\r\n                            athletes: {\r\n                                attribute: [\"\"],\r\n                                order: \"\"\r\n                            },\r\n                            trainingSessions: {\r\n                                attribute: [\"date\"],\r\n                                order: \"ASC\"\r\n                            }\r\n                        }\r\n                    },\r\n                    ui: {\r\n                        activeRoute: \"home\",\r\n                        activeView: \"Startpage\",  \r\n                        currentAthlete: null,\r\n                        routeParameters: {},\r\n                        appLoading: false\r\n                    },\r\n                };\r\n                // instantiate store with initState\r\n                const store = new Store(initState);\r\n                this.reduxStore = store.store;\r\n\r\n                // loading data \r\n                this.commonActions = new commonActions();\r\n                preprocessor.fetchData(aUrls).then((result)=>{\r\n                    const oLoadDataAction = this.commonActions.loadData({oData: preprocessor.processAthletes(result), sEntityName: \"athletes\"});\r\n                    this.reduxStore.dispatch(oLoadDataAction);\r\n                });\r\n\r\n                // Callback in case of store change\r\n                this.reduxStore.subscribe(() =>{\r\n                    console.log('State after dispatch: ', this.reduxStore.getState())\r\n                    const oState = this.reduxStore.getState();\r\n\r\n                    this.oRouter.navTo(commonSelectors.selectActiveRoute(oState), commonSelectors.selectRouteParameters(oState));\r\n\r\n                    // Reset model data if changes are present\r\n                    oAthleteModel.setData(commonSelectors.selectVisibleAthletes(oState, \"athletes\"));\r\n\r\n                    // Set visible sessions data\r\n                    if(commonSelectors.selectActiveView(oState) === \"AthleteDetails\"){\r\n                         oAthleteDetailsModel.setData(commonSelectors.selectVisibleSessions(oState, \"trainingSessions\"));\r\n                    }\r\n                    \r\n                })\r\n\r\n            const i18nModel = new ResourceModel({\r\n                bundleName: \"ui5.fitnessApp.i18n.i18n\"\r\n             });\r\n             this.setModel(i18nModel, \"i18n\");\r\n             \r\n            this.getRouter().initialize();\r\n\t\t},\r\n\r\n    });\r\n });\r\n "],"mappings":"AACAA,IAAIC,GAAGC,OAAO,CACX,0BACA,8BACA,sCACA,wCACA,uBACA,sBACA,sBACF,8BACA,0BACG,2CACA,uCACA,sBACD,CAACC,EAAaC,EAAWC,EAAeC,EAAkBC,EAAOC,EAAQC,EAAQC,EAAgBC,EAAYC,EAAiBC,EAAeC,KAC5I,aAEA,OAAOX,EAAYY,OAAO,2BAA4B,CAElDC,SAAW,CACPC,WAAc,CAAC,qCACfC,SAAY,QAGhBC,OAEIhB,EAAYiB,UAAUD,KAAKE,MAAMC,KAAMC,WAGvC,IAAIC,EAAgB,IAAIpB,EACxBoB,EAAcC,sBAAsBzB,IAAIC,GAAGyB,MAAMC,YAAYC,QAC7DN,KAAKO,SAASL,EAAe,gBAE5B,IAAIM,EAAuB,IAAI1B,EAChC0B,EAAqBL,sBAAsBzB,IAAIC,GAAGyB,MAAMC,YAAYC,QACpEN,KAAKO,SAASC,EAAsB,uBAGpCR,KAAKS,QAAUT,KAAKU,YAGpB,MAAMC,EAAQ,CAAC,mCAAoC,6CACnD,MAAMC,EAAe,IAAI5B,EAGrB,MAAM6B,EAAY,CACdC,SAAU,CACNC,SAAU,CAAC,EACXC,iBAAkB,CAAC,EACnBC,MAAO,CAAC,GAEZC,IAAK,CACDC,QAAQ,CACJJ,SAAS,CACLK,UAAW,CAAC,WACZC,MAAO,KAGfC,QAAS,CACLP,SAAU,CACNK,UAAW,CAAC,IACZG,MAAO,IAEXP,iBAAkB,CACdI,UAAW,CAAC,QACZG,MAAO,SAInB5C,GAAI,CACA6C,YAAa,OACbC,WAAY,YACZC,eAAgB,KAChBC,gBAAiB,CAAC,EAClBC,WAAY,QAIpB,MAAMC,EAAQ,IAAI5C,EAAM4B,GACxBb,KAAK8B,WAAaD,EAAMA,MAGxB7B,KAAKT,cAAgB,IAAIA,EACzBqB,EAAamB,UAAUpB,GAAOqB,KAAMC,IAChC,MAAMC,EAAkBlC,KAAKT,cAAc4C,SAAS,CAACC,MAAOxB,EAAayB,gBAAgBJ,GAASK,YAAa,aAC/GtC,KAAK8B,WAAWS,SAASL,EAAgB,GAI7ClC,KAAK8B,WAAWU,UAAU,KACtBC,QAAQC,IAAI,yBAA0B1C,KAAK8B,WAAWa,YACtD,MAAMC,EAAS5C,KAAK8B,WAAWa,WAE/B3C,KAAKS,QAAQoC,MAAMvD,EAAgBwD,kBAAkBF,GAAStD,EAAgByD,sBAAsBH,IAGpG1C,EAAc8C,QAAQ1D,EAAgB2D,sBAAsBL,EAAQ,aAGpE,GAAGtD,EAAgB4D,iBAAiBN,KAAY,iBAAiB,CAC5DpC,EAAqBwC,QAAQ1D,EAAgB6D,sBAAsBP,EAAQ,oBAChF,IAIR,MAAMQ,EAAY,IAAIrE,EAAc,CAChCsE,WAAY,6BAEfrD,KAAKO,SAAS6C,EAAW,QAE1BpD,KAAKU,YAAY4C,YAC3B,GAEI","ignoreList":[]}