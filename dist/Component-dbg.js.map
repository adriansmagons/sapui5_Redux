{"version":3,"names":["sap","ui","define","UIComponent","JSONModel","ResourceModel","DataPreprocessor","Store","Sorter","Filter","FilterOperator","FilterType","commonSelectors","commonActions","MessageToast","extend","metadata","init","prototype","apply","arguments","oAthleteModel","setDefaultBindingMode","model","BindingMode","OneWay","setModel","oAthleteDetailsModel","oRouter","getRouter","aUrls","preprocessor","initState","entities","athletes","trainingSessions","games","app","filters","attribute","query","sorting","order","activeRoute","activeView","currentAthlete","routeParameters","appLoading","store","reduxStore","fetchData","then","result","oLoadDataAction","loadData","oData","processAthletes","sEntityName","dispatch","subscribe","console","log","getState","oState","navTo","selectActiveRoute","selectRouteParameters","setData","selectVisibleAthletes","selectActiveView","selectVisibleSessions","i18nModel","bundleName","initialize"],"sources":["Component.js"],"sourcesContent":["\r\nsap.ui.define([\r\n   \"sap/ui/core/UIComponent\",\r\n   \"sap/ui/model/json/JSONModel\",\r\n   \"sap/ui/model/resource/ResourceModel\",\r\n   \"ui5/fitnessApp/utils/DataPreprocessor\",\r\n   \"ui5/fitnessApp/store\",\r\n   \"sap/ui/model/Sorter\",\r\n   \"sap/ui/model/Filter\",\r\n\t\"sap/ui/model/FilterOperator\",\r\n\t\"sap/ui/model/FilterType\",\r\n    \"ui5/fitnessApp/selectors/commonSelectors\",\r\n    \"ui5/fitnessApp/actions/commonActions\",\r\n    \"sap/m/MessageToast\",\r\n], (UIComponent, JSONModel, ResourceModel, DataPreprocessor, Store, Sorter, Filter, FilterOperator, FilterType, commonSelectors, commonActions, MessageToast) => {\r\n    \"use strict\";\r\n \r\n    return UIComponent.extend(\"ui5.fitnessApp.Component\", {\r\n\r\n        metadata : {\r\n            \"interfaces\": [\"sap.ui.core.IAsyncContentCreation\"],\r\n            \"manifest\": \"json\",\r\n         },\r\n\r\n        init() {\r\n             // call the init function of the parent\r\n            UIComponent.prototype.init.apply(this, arguments);\r\n\r\n            // change default binding mode to oneway\r\n            var oAthleteModel = new JSONModel();\r\n            oAthleteModel.setDefaultBindingMode(sap.ui.model.BindingMode.OneWay);\r\n            this.setModel(oAthleteModel, \"athleteModel\");\r\n\r\n             var oAthleteDetailsModel = new JSONModel();\r\n            oAthleteDetailsModel.setDefaultBindingMode(sap.ui.model.BindingMode.OneWay);\r\n            this.setModel(oAthleteDetailsModel, \"athleteDetailsModel\");\r\n\r\n            // router reference\r\n            this.oRouter = this.getRouter();\r\n\r\n            // fetch data and preprocess\r\n            const aUrls = ['/client/model/data/athletes.json', '/client/model/data/training_sessions.json'];\r\n            const preprocessor = new DataPreprocessor();\r\n\r\n                // create initial state for store and instantiate store\r\n                const initState = {\r\n                    entities: {\r\n                        athletes: {},\r\n                        trainingSessions: {},\r\n                        games: {}\r\n                    },\r\n                    app: {\r\n                        filters:{\r\n                            athletes:{\r\n                                attribute: [\"surname\"],\r\n                                query: \"\"\r\n                            }\r\n                        },\r\n                        sorting: {\r\n                            athletes: {\r\n                                attribute: [\"\"],\r\n                                order: \"\"\r\n                            },\r\n                            trainingSessions: {\r\n                                attribute: [\"date\"],\r\n                                order: \"ASC\"\r\n                            }\r\n                        }\r\n                    },\r\n                    ui: {\r\n                        activeRoute: \"home\",\r\n                        activeView: \"Startpage\",  \r\n                        currentAthlete: null,\r\n                        routeParameters: {},\r\n                        appLoading: false\r\n                    },\r\n                };\r\n                // instantiate store with initState\r\n                const store = new Store(initState);\r\n                this.reduxStore = store.store;\r\n\r\n                // loading data \r\n                this.commonActions = new commonActions();\r\n                preprocessor.fetchData(aUrls).then((result)=>{\r\n                    const oLoadDataAction = this.commonActions.loadData({oData: preprocessor.processAthletes(result), sEntityName: \"athletes\"});\r\n                    this.reduxStore.dispatch(oLoadDataAction);\r\n                });\r\n\r\n                // Callback in case of store change\r\n                this.reduxStore.subscribe(() =>{\r\n                    console.log('State after dispatch: ', this.reduxStore.getState())\r\n                    const oState = this.reduxStore.getState();\r\n\r\n                    this.oRouter.navTo(commonSelectors.selectActiveRoute(oState), commonSelectors.selectRouteParameters(oState));\r\n\r\n                    // Reset model data if changes are present\r\n                    oAthleteModel.setData(commonSelectors.selectVisibleAthletes(oState, \"athletes\"));\r\n\r\n                    // Set visible sessions data\r\n                    if(commonSelectors.selectActiveView(oState) === \"AthleteDetails\"){\r\n                         oAthleteDetailsModel.setData(commonSelectors.selectVisibleSessions(oState, \"trainingSessions\"));\r\n                    }\r\n                    \r\n                })\r\n\r\n            const i18nModel = new ResourceModel({\r\n                bundleName: \"ui5.fitnessApp.i18n.i18n\"\r\n             });\r\n             this.setModel(i18nModel, \"i18n\");\r\n             \r\n            this.getRouter().initialize();\r\n\t\t},\r\n\r\n    });\r\n });\r\n "],"mappings":"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","ignoreList":[],"file":"Component-dbg.js"}