{"version":3,"file":"Startpage.controller.js","names":["sap","ui","define","Controller","MessageToast","startPageActions","commonActions","commonSelectors","entitySlice","ColumnMenu","QuickSort","QuickSortItem","Menu","MenuItem","Column","Text","extend","onInit","this","oStartPageActions","oCommonActions","createSurnameSort","oTable","getView","byId","aColumns","getColumns","oSurnameColumn","setHeaderMenu","quickActions","items","key","label","change","onSort","bind","onAthletePress","oEvent","document","activeElement","blur","oContext","getSource","getBindingContext","nAthleteId","getProperty","sTargetRoute","sRouteParameters","athletePath","window","encodeURIComponent","getPath","substring","sCurrentView","oView","sViewName","split","at","oNavigateAction","navigateTo","sView","sOldView","getOwnerComponent","reduxStore","dispatch","onSelectTab","sKey","getParameter","sSortOrder","getSortOrder","oSortTableAction","sortTable","sOrder","sAttribute","sEntityName","onSearch","sQuery","getValue","oSearchAction","searchBySurname","onRefresh","oRefreshAction","refreshTable","onOpenInsertDialog","open","onCloseInsertDialog","getParent","close","onInsertRow","sNewId","selectUniqueAthleteId","getState","oAthlete","_id","name","surname","position","age","gender","oInsertAthleteAction","insertAthlete","setValue","toggleDeleteRow","getPressed","oSelectColumn","header","text","addColumn","removeColumn","length","onDeleteRow","sAthleteId","oDeleteAthleteAction","deleteAthlete","onFetchFromServer","show","fetchAthletes"],"sources":["Startpage.controller.js"],"sourcesContent":["\r\nsap.ui.define([\r\n    \"sap/ui/core/mvc/Controller\",\r\n    'sap/m/MessageToast',\r\n    \"ui5/fitnessApp/actions/startPageActions\",\r\n    \"ui5/fitnessApp/actions/commonActions\",\r\n    \"ui5/fitnessApp/selectors/commonSelectors\",\r\n    \"ui5/fitnessApp/features/entitySlice\",\r\n    \"sap/m/table/columnmenu/Menu\",\r\n    \"sap/m/table/columnmenu/QuickSort\",\r\n    \"sap/m/table/columnmenu/QuickSortItem\",\r\n    \"sap/m/Menu\",\r\n    \"sap/m/MenuItem\",\r\n    \"sap/m/Column\",\r\n\t\"sap/m/Text\",\r\n ], (Controller, MessageToast, startPageActions, commonActions, commonSelectors, entitySlice, ColumnMenu, QuickSort, QuickSortItem, Menu, MenuItem, Column, Text) => {\r\n    \"use strict\";\r\n \r\n    return Controller.extend(\"ui5.fitnessApp.controller.Startpage\", {\r\n    \r\n        onInit: function () {\r\n            this.oStartPageActions = new startPageActions();\r\n            this.oCommonActions = new commonActions();\r\n            this.createSurnameSort();\r\n        },\r\n\r\n        createSurnameSort: function(){\r\n            const oTable = this.getView().byId(\"players_table\");  \r\n\t\t\tconst aColumns = oTable.getColumns();\r\n            const oSurnameColumn = aColumns[1];\r\n\r\n            oSurnameColumn.setHeaderMenu(new ColumnMenu({\r\n\t\t\t\tquickActions: [\r\n\t\t\t\t\tnew QuickSort({\r\n\t\t\t\t\t\titems: new QuickSortItem({\r\n\t\t\t\t\t\t\tkey: \"Surname\",\r\n\t\t\t\t\t\t\tlabel: \"Surname\"\r\n\t\t\t\t\t\t}),\r\n\t\t\t\t\t\tchange: this.onSort.bind(this)\r\n\t\t\t\t\t})\r\n\t\t\t\t]\r\n\t\t\t}));\r\n        },\r\n\r\n        onAthletePress: function (oEvent) {  \r\n            document.activeElement.blur();\r\n\r\n            let oContext = oEvent.getSource().getBindingContext(\"athleteModel\");\r\n            let nAthleteId = oContext.getProperty(\"_id\");  \r\n            let sTargetRoute = \"athleteDetails\";\r\n            let sRouteParameters = {athletePath: window.encodeURIComponent(oContext.getPath().substring(1))};\r\n\r\n            const sCurrentView = this.oView.sViewName.split('.').at(-1)\r\n            const oNavigateAction = this.oCommonActions.navigateTo({sView: \"AthleteDetails\", sOldView: sCurrentView, sTargetRoute: sTargetRoute, sRouteParameters: sRouteParameters, nAthleteId: nAthleteId});\r\n            this.getOwnerComponent().reduxStore.dispatch(oNavigateAction);\r\n        },\r\n\r\n        onSelectTab: function(oEvent){\r\n            let sTargetRoute = \"home\";\r\n            const sKey = oEvent.getParameter(\"key\");\r\n\r\n            switch(sKey){\r\n                case \"Startpage\":\r\n                    sTargetRoute = \"home\";\r\n                    break;\r\n                case \"Profile\":\r\n                    sTargetRoute = \"profile\";\r\n                    break;\r\n            }\r\n\r\n            const sCurrentView = this.oView.sViewName.split('.').at(-1)\r\n            const oNavigateAction = this.oCommonActions.navigateTo({sView: sKey, sOldView: sCurrentView, sTargetRoute: sTargetRoute, nAthleteId: null});\r\n            this.getOwnerComponent().reduxStore.dispatch(oNavigateAction);\r\n        },\r\n\r\n        onSort: function(oEvent){\r\n            let sSortOrder = oEvent.getParameter(\"item\").getSortOrder();\r\n            if(sSortOrder === \"Ascending\"){\r\n                sSortOrder = \"ASC\"\r\n            }else if(sSortOrder === \"Descending\"){\r\n                sSortOrder = \"DESC\"\r\n            }else{\r\n                sSortOrder = \"\"\r\n            }\r\n            const oSortTableAction = this.oCommonActions.sortTable({sOrder: sSortOrder, sAttribute: [\"surname\"], sEntityName: \"athletes\"});\r\n            this.getOwnerComponent().reduxStore.dispatch(oSortTableAction);\r\n        },\r\n        onSearch: function(oEvent){\r\n            let sQuery = oEvent.getSource().getValue();\r\n            const oSearchAction = this.oCommonActions.searchBySurname({sQuery: sQuery, sAttribute: [\"surname\"], sEntityName: \"athletes\"});\r\n            this.getOwnerComponent().reduxStore.dispatch(oSearchAction);\r\n        },\r\n        \r\n        onRefresh: function(){\r\n            const oRefreshAction = this.oCommonActions.refreshTable({sOrder: \"\", sAttribute: [\"\"], sEntityName: \"athletes\"});\r\n            this.getOwnerComponent().reduxStore.dispatch(oRefreshAction);\r\n        },\r\n\r\n        onOpenInsertDialog: function(){\r\n            this.getView().byId(\"idInsertDialog\").open();\r\n        },\r\n        onCloseInsertDialog: function(oEvent){\r\n            oEvent.getSource().getParent().close();\r\n        },\r\n        onInsertRow: function(oEvent){\r\n            const sNewId = commonSelectors.selectUniqueAthleteId(this.getOwnerComponent().reduxStore.getState());  // selects unique id from athlete list\r\n            const oAthlete = {\r\n                    _id: sNewId,\r\n                    name: this.getView().byId(\"nameInput\").getValue(),\r\n                    surname: this.getView().byId(\"surnameInput\").getValue(),\r\n                    position: this.getView().byId(\"positionInput\").getValue(),\r\n                    age: this.getView().byId(\"ageInput\").getValue(),\r\n                    gender: this.getView().byId(\"genderInput\").getValue()}\r\n\r\n            const oInsertAthleteAction = this.oCommonActions.insertAthlete({oAthlete:oAthlete});\r\n            this.getOwnerComponent().reduxStore.dispatch(oInsertAthleteAction);\r\n\r\n            this.getView().byId(\"nameInput\").setValue(\"\"),\r\n            this.getView().byId(\"surnameInput\").setValue(\"\"),\r\n            this.getView().byId(\"positionInput\").setValue(\"\"),\r\n            this.getView().byId(\"ageInput\").setValue(\"\"),\r\n            this.getView().byId(\"genderInput\").setValue(\"\")\r\n            oEvent.getSource().getParent().close();\r\n        },\r\n        toggleDeleteRow: function(oEvent){\r\n            const oTable = this.getView().byId(\"players_table\");\r\n\r\n\t\t\tif(oEvent.getSource().getPressed()){\r\n\t\t\t\tthis.oSelectColumn = new Column({\r\n\t\t\t\t\theader: new Text ({text: \"Select\"})\r\n\t\t\t\t});\r\n\t\t\t\toTable.addColumn(this.oSelectColumn);\r\n\t\t\t}else{\r\n\t\t\t\toTable.removeColumn(oTable.getColumns().length - 1);\r\n\t\t\t}\r\n        },\r\n        onDeleteRow: function(oEvent){\r\n            let oContext = oEvent.getSource().getBindingContext(\"athleteModel\");\r\n\t\t\tlet sAthleteId = oContext.getProperty(\"_id\");\r\n            const oDeleteAthleteAction = this.oCommonActions.deleteAthlete({sAthleteId: sAthleteId});\r\n            this.getOwnerComponent().reduxStore.dispatch(oDeleteAthleteAction);\r\n        },\r\n\r\n        onFetchFromServer: function(oEvent){\r\n            MessageToast.show(\"Fetching data\");\r\n            this.getOwnerComponent().reduxStore.dispatch(entitySlice.fetchAthletes);\r\n        },\r\n    });\r\n });"],"mappings":"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","ignoreList":[]}